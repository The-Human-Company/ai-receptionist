# Generate Content

Generate content packages (LinkedIn posts, Instagram scripts, lead magnets, newsletters) from research papers, topics, or ideas using the NGM content pipeline.

## Usage

Invoke this skill when the user wants to:
- Generate social media content from a research paper or topic
- Create a LinkedIn post about a longevity/health topic
- Create an Instagram script
- Generate a lead magnet with HTML and SVG diagrams
- Generate a Substack newsletter
- Run the full content pipeline

## Pipelines

The content pipeline supports two modes:

### Clinical Pipeline (default)
Best for medical/scientific content. Flow: VectorShift lead magnet → LinkedIn/Instagram/Newsletter derived from lead magnet.

### Non-Clinical Pipeline
Best for business, AI, or general topics. Flow: Newsletter generated first with SVG diagrams → LinkedIn/Instagram derived from newsletter.

## Parameters

The user may specify:
- **Input**: A research topic, paper abstract, or question (required)
- **Pipeline**: `clinical` or `nonclinical` (default: clinical)
- **Content Types**: Which content to generate (linkedin, instagram, lead_magnet, newsletter, or all)
- **Keyword**: CTA keyword for lead magnet access (e.g., "GSH", "NAD", "COLD")
- **Publish**: Whether to auto-commit to git (default: true)
- **Images**: Whether to generate visual assets (default: true)
- **Min Diagrams**: Minimum SVG diagrams for lead magnets (1-7, default: 3)
- **Paid/Gated**: For subscriber-only content, use `generate-gated` command instead (see Gated Content section below)

## Execution

1. **Parse the user's request** to extract:
   - The input topic/paper (can be a URL, abstract, or topic description)
   - Which pipeline to use (clinical vs nonclinical)
   - Which content types to generate (default: all)
   - The CTA keyword (extract from topic if not specified)

2. **Set up environment** and run the pipeline:

**Clinical Pipeline (default - for medical/scientific content):**
```bash
cd "/Users/anantvinjamoori/NGM Site NextJS V1/ngm-website-official"
export $(grep -v '^#' .env | xargs)
python3 -m lib.content_pipeline.cli generate \
  --input "YOUR_INPUT_HERE" \
  --pipeline clinical \
  --linkedin \
  --instagram \
  --lead-magnet \
  --newsletter \
  --keyword "KEYWORD" \
  --min-diagrams 5 \
  --publish
```

**Non-Clinical Pipeline (for business/AI/general topics):**
```bash
cd "/Users/anantvinjamoori/NGM Site NextJS V1/ngm-website-official"
export $(grep -v '^#' .env | xargs)
python3 -m lib.content_pipeline.cli generate \
  --input "YOUR_INPUT_HERE" \
  --pipeline nonclinical \
  --linkedin \
  --instagram \
  --newsletter \
  --publish
```

3. **Adjust flags based on user request**:
   - Use `--pipeline clinical` or `--pipeline nonclinical` to select flow
   - Use `--no-linkedin` to skip LinkedIn post
   - Use `--no-instagram` to skip Instagram script
   - Use `--no-lead-magnet` to skip lead magnet (clinical only)
   - Use `--no-newsletter` to skip newsletter generation
   - Use `--no-images` to skip image generation
   - Use `--no-publish` to skip auto-commit
   - Use `--min-diagrams N` to set minimum diagrams (1-7, default: 3)

4. **Report results** including:
   - LinkedIn post content and quality status
   - Instagram script with duration
   - Lead magnet with HTML link
   - Newsletter title, format, and word count
   - Generated images count
   - Total elapsed time

## Content Types

### LinkedIn Post
- Contrarian, Secret, or Stakes hook
- ~200-300 words
- Quality critique loop (up to 3 iterations)
- SVG diagram + Nano Banana Pro images

### Instagram Script
- 30-90 second spoken duration
- Hook, Body, CTA structure
- Quality critique loop
- Visual assets

### Lead Magnet
- JSON structure + styled HTML
- 3-7 diverse SVG diagrams following NGM style guide (configurable via --min-diagrams)
- Diagram types include: mechanism pathways, process flows, comparisons, cellular visualizations, concept diagrams
- ~1000 word article in Andrew Huberman voice
- Mechanism/takeaway table
- References section

### Substack Newsletter (VectorShift Pipeline)
- **Generated via VectorShift every_newsletter_generator_v2 pipeline** (ID: 6967e132451a2ec1a57fb7da)
- Includes Perplexity research for up-to-date information
- 2-3 embedded SVG diagrams generated by the pipeline
- Email-ready HTML output with NGM style guide applied
- Title and subtitle extracted from pipeline output
- **Every.to editorial voice** automatically applied by the VectorShift pipeline

**Every.to Voice Techniques Applied:**
All newsletters now use Every.to editorial standards:
- **Colon technique**: "Here's what matters:" for concept introductions
- **Em-dashes**: Clarity (definitions), asides (context), contrast (emphasis)
- **One-sentence paragraphs**: 3-6 per piece at high-impact moments
- **Evidence cascade**: Stack 3+ specific examples with connectors
- **Specificity**: Names, numbers, timeframes in EVERY claim

**Newsletter Formats & Every.to Voice:**
| Format | Every.to Voice | Key Techniques |
|--------|----------------|----------------|
| `thesis_essay` | Core argument | Evidence cascade, colon technique, rhythm (long→short→medium) |
| `clinical_casefile` | Mechanism deep-dive | Specific clinical scenarios, study citations "Author et al., Journal, Year" |
| `scientific_breakthrough` | Research analysis | Study result hooks, methodological em-dashes, evidence cascade |
| `industry_brief` | Tina He's strategic voice | Deal/valuation hooks, framework naming, evocative archetypes |
| `ai_in_clinic_playbook` | Katie Parrott's practical voice | Quantified workflow problems, exact tools/versions/pricing |
| `context_window_digest` | Rhea Purohit's journalistic voice | Pattern recognition across sources, em-dash attribution |
| `personal_narrative_with_lesson` | Dan Shipper's philosophical voice | In medias res opening, em-dash vulnerability, metaphor callback |

**Every.to Quality Rubric (8 Criteria):**
Newsletters are evaluated against:
1. `specificity_check` - Names, numbers, timeframes present
2. `evidence_cascade_present` - 3+ stacked examples
3. `colon_technique_used` - Concept introductions
4. `em_dash_clarity` - Proper em-dash usage
5. `one_sentence_emphasis` - Strategic standalone sentences
6. `concrete_over_abstract` - Tangible opening details
7. `voice_authenticity` - Every.to voice principles
8. `forward_looking_conclusion` - Implications, not summaries

**Before/After Examples:**

❌ **Before (generic):**
> "Many researchers believe intermittent fasting may have significant benefits for longevity. Recent studies have shown promising results."

✅ **After (Every.to voice):**
> "Levine and colleagues at Yale, Nature Aging, January 2026 just showed that time-restricted eating reversed 3.2 years of epigenetic aging in 247 adults over 12 months—a 15% larger effect than caloric restriction alone. Here's what this means for clinical practice: the intervention window matters more than the duration."

**Key Every.to Quick Fixes:**
- "Many companies" → "Oracle, CoreWeave, and Scale AI"
- "Significant growth" → "From $300M to $2.5B"
- "Recently" → "Between early 2025 and the fall"
- "Experts say" → "Reid Hoffman predicts"

## Example Invocations

**Full clinical pipeline from topic:**
```
/generate-content Does intermittent fasting improve longevity?
```

**Non-clinical pipeline for AI/business topics:**
```
/generate-content --pipeline nonclinical How AI is transforming clinical workflows
```

**LinkedIn only:**
```
/generate-content --linkedin-only NAD+ supplementation and aging
```

**Newsletter only (non-clinical):**
```
/generate-content --pipeline nonclinical --no-linkedin --no-instagram The future of longevity medicine business models
```

**From research paper:**
```
/generate-content [paste paper abstract or key findings]
```

**With specific keyword:**
```
/generate-content --keyword FAST Does time-restricted eating affect metabolism?
```

**With more diagrams:**
```
/generate-content --min-diagrams 5 How does cold exposure affect brown adipose tissue?
```

**Clinical pipeline with newsletter:**
```
/generate-content --pipeline clinical --newsletter --keyword MITO Mitochondrial dysfunction in aging
```

## Output Locations

- LinkedIn: `content/social-content/linkedin-posts/`
- Instagram: `content/social-content/instagram-scripts/`
- Lead Magnets: `content/learn-platform/lead-magnets/`
- Newsletters: `content/social-content/newsletters/`
- Images: `content/graphics/generated/`

## Review Interface

After generation, content can be reviewed at:
- http://localhost:3000/content-pipeline

### Newsletter Preview Features
The content pipeline viewer includes enhanced newsletter support:
- **HTML Preview**: View the full rendered newsletter with SVG diagrams in an embedded iframe
- **Copy HTML Button**: Copy the complete HTML to clipboard for pasting into email generators (HubSpot, Mailchimp, etc.)
- **Open Full View**: Open the newsletter in a new tab for full-screen viewing
- **Toggle View**: Switch between HTML preview and raw markdown

### API Endpoints
- `GET /api/newsletter-html/{slug}` - Serve rendered HTML newsletter
- `GET /api/newsletter-html/{slug}?raw=true` - Get raw HTML as JSON for copying

## Gated Content (Subscriber-Only)

For content that should be gated behind a subscription, use the **`generate-gated`** command instead:

```bash
python3 -m lib.content_pipeline.cli generate-gated \
  --input "YOUR_INPUT_HERE" \
  --pipeline clinical \
  --paid \
  --cutoff 0.45 \
  --newsletter \
  --linkedin \
  --instagram \
  --publish
```

This creates TWO versions:
- **Teaser**: First 40-50% with subscription CTA (for email distribution)
- **Full**: Complete article for subscriber-only Analysis section

See `/generate-gated-content` skill for full documentation.

### Gated Content Output Locations
- `content/analyses/{date}-{slug}-full.html` - Full subscriber content
- `content/analyses/{date}-{slug}-teaser.html` - Truncated email teaser

### Integration with Mentorship Content

After generating gated content, add an entry to `content/analyses/registry.ts` with:
- Slug, title, subtitle
- Category (`clinical`, `business`, `ai`, `longevity`, `nutrition`, `hormones`)
- Access tier (`core`, `professional`, `elite`)
- Paths to full and teaser HTML files

The analysis will appear in the **Analyses tab** of the Mentorship Content page (`/mentorship-content?tab=analyses`), accessible only to subscribers at the specified tier or higher.

## Notes

- Pipeline takes 3-6 minutes depending on content types
- VectorShift briefing generation takes ~3 minutes
- **VectorShift newsletter pipeline takes ~5-10 minutes** (includes Perplexity research)
- Newsletter pipeline has **automatic task_id fallback** - if timeout occurs, the task_id is used to automatically retry fetching results (no manual span ID lookup needed)
- Claude Opus is used for content generation and critique
- Claude Opus 4 is used for SVG diagram generation
- Gemini is used for Nano Banana Pro images
- NGM style guide is automatically applied to newsletter HTML (Inter body font, Newsreader headlines)
